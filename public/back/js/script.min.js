"use strict";

$(document).ready(function () {
    "use strict";

    $('[data-toggle="tooltip"]').tooltip()

    $('.select2').select2({
        placeholder: 'Lütfen Seçim Yapınız',
        closeOnSelect : false,
        theme: 'bootstrap4',
    });
    $('.datatable').DataTable({
        oLanguage: {
            oAria: {
                sSortAscending: ": activate to sort column ascending",
                sSortDescending: ": activate to sort column descending"
            },
            oPaginate: {
                sFirst: "İlk",
                sLast: "Son",
                sNext: "Sonraki",
                sPrevious: "Önceki"
            },
            sEmptyTable: "Tablo'da içerik bulunmamaktadır",
            sInfo: "_TOTAL_ içerikten _START_ / _END_ tanesi gösteriliyor",
            sInfoEmpty: "Showing 0 to 0 of 0 entries",
            sInfoFiltered: "(filtered from _MAX_ total entries)",
            sInfoPostFix: "",
            sDecimal: "",
            sThousands: ",",
            sLengthMenu: "_MENU_ İçerik",
            sLoadingRecords: "Yükleniyor...",
            sProcessing: "İşleniyor...",
            sSearch: "Ara:",
            sSearchPlaceholder: "",
            sUrl: "",
            sZeroRecords: "Bulunan Kayıt Yok"
        }
    });
    dropifyInit();
    priceFormat();


    var $searchInput = $(".search-bar input");
    var $searchCloseBtn = $(".search-close"); // Reusable utilities

    window.gullUtils = {
        isMobile: function isMobile() {
            return window && window.matchMedia("(max-width: 767px)").matches;
        },
        changeCssLink: function changeCssLink(storageKey, fileUrl) {
            localStorage.setItem(storageKey, fileUrl);
            location.reload();
        }
    }; // Search toggle

    var $searchUI = $(".search-ui");
    $searchInput.on("focus", function () {
        $searchUI.addClass("open");
    });
    $searchCloseBtn.on("click", function () {
        $searchUI.removeClass("open");
    }); // Secondary sidebar dropdown menu

    var $dropdown = $(".dropdown-sidemenu");
    var $subMenu = $(".submenu");
    $dropdown.find("> a").on("click", function (e) {
        e.preventDefault();
        e.stopPropagation();
        var $parent = $(this).parent(".dropdown-sidemenu");
        $dropdown.not($parent).removeClass("open");
        $(this).parent(".dropdown-sidemenu").toggleClass("open");
    }); // Perfect scrollbar

    $(".perfect-scrollbar, [data-perfect-scrollbar]").each(function (index) {
        var $el = $(this);
        var ps = new PerfectScrollbar(this, {
            suppressScrollX: $el.data("suppress-scroll-x"),
            suppressScrollY: $el.data("suppress-scroll-y")
        });
    }); // Full screen

    function cancelFullScreen(el) {
        var requestMethod = el.cancelFullScreen || el.webkitCancelFullScreen || el.mozCancelFullScreen || el.exitFullscreen;

        if (requestMethod) {
            // cancel full screen.
            requestMethod.call(el);
        } else if (typeof window.ActiveXObject !== "undefined") {
            // Older IE.
            var wscript = new ActiveXObject("WScript.Shell");

            if (wscript !== null) {
                wscript.SendKeys("{F11}");
            }
        }
    }

    function requestFullScreen(el) {
// Supports most browsers and their versions.
        var requestMethod = el.requestFullScreen || el.webkitRequestFullScreen || el.mozRequestFullScreen || el.msRequestFullscreen;

        if (requestMethod) {
// Native full screen.
            requestMethod.call(el);
        } else if (typeof window.ActiveXObject !== "undefined") {
// Older IE.
            var wscript = new ActiveXObject("WScript.Shell");

            if (wscript !== null) {
                wscript.SendKeys("{F11}");
            }
        }

        return false;
    }

    function toggleFullscreen() {
        var elem = document.body;
        var isInFullScreen = document.fullScreenElement && document.fullScreenElement !== null || document.mozFullScreen || document.webkitIsFullScreen;

        if (isInFullScreen) {
            cancelFullScreen(document);
        } else {
            requestFullScreen(elem);
        }

        return false;
    }

    $("[data-fullscreen]").on("click", toggleFullscreen);
});


$(document).on('change','.js-stock_status',function (){
    $('.js-stock_input').prop('readonly',false)
    if(this.value == '1')
        $('.js-stock_input').prop('readonly',true)
})


var dropifyInit = function (elem = $('.dropify'),defaultFile = ""){

    elem.dropify({
        messages: {
            'default': 'Bir dosya sürükleyip bırakın veya tıklayın',
            'replace': 'Değiştirmek için sürükleyip bırakın veya tıklayın',
            'remove':  'Kaldır',
            'error':   'Maalesef bir sorun oldu.'
        },
        defaultFile : defaultFile,
        error: {
            'fileSize': 'Dosya boyutu çok büyük (maksimum {{value}}).',
            'minWidth': 'Resim genişliği çok küçük.( minimum değer {{ value }}px).',
            'maxWidth': 'Resim genişliği çok büyük.( maximum değer {{ value }}px).',
            'minHeight': 'Resim yüksekliği çok küçük.( minimum değer {{ value }}}px).',
            'maxHeight': 'Resim yüksekliği çok büyük.( maximum değer {{ value }}px).',
            'imageFormat': 'Görüntü biçimine izin verilmiyor. ( yalnızca {{ value }} uzantıları geçerlidir).'
        }
    })
}

var priceFormat = function (){
    $(".price_format").priceFormat({
        prefix: '',
        centsSeparator: ',',
        thousandsSeparator: '.'
    });
}

var redirectSwal = function (route = "",formid = "", title = "Silmek İstediğinize Emin Misiniz?", text = "Silme İşlemi Yapmak İstediğinize Emin Misiniz"){
    swal({
        title: title,
        text: text,
        type: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#0CC27E',
        cancelButtonColor: '#FF586B',
        confirmButtonText: 'Evet',
        cancelButtonText: 'Hayır',
        confirmButtonClass: 'btn btn-success mr-5',
        cancelButtonClass: 'btn btn-danger',
        buttonsStyling: false
    }).then(function () {
        if(formid != ""){
            $(formid).submit();
        }else{
            window.location.href = route;
        }
    }, function (dismiss) {

    });
}

// PreLoader
// $(window).load(function() {
//     $('#preloader').fadeOut('slow', function() {
//         $(this).remove();
//     });
// });
// makes sure the whole site is loaded

$(window).on("load", function () {
    // will first fade out the loading animation
    jQuery("#loader").fadeOut(); // will fade out the whole DIV that covers the website.

    jQuery("#preloader").delay(500).fadeOut("slow");
});

/*
window.onscroll = function() {
    if(parseInt($(window).scrollTop()) > parseInt($(".fixedTable").offset().top)){
        $(".fixedTable").addClass("fixed");
    }else{
        $(".fixedTable").removeClass("fixed");
    }
};
*/

$( "form" ).submit(function( event ) {
    $(this).find("[type='submit']").addClass("customLoading");
});

